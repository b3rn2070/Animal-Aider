{% extends 'base.html' %}
{% block conteudo %}

<div class="container my-5">
    <h1 class="mb-4 text-center text-primary">Relatório de Resgate</h1>
  <div class="p-4 bg-white rounded shadow-sm" style="max-width: 600px; margin: auto;">
    <form action="{{ url_for('rescue')}}" method="post" enctype="multipart/form-data" class="needs-validation form-control" novalidate>

      {% if session.get('logged') %}
        <!-- Dados de usuário logado -->
        <input type="hidden" name="userId" value="{{ session.get('user_id') }}">
        <input type="hidden" name="author" value="{{ session.get('user_name') }}">
        <input type="hidden" name="phone" value="{{ session.get('user_phone') }}">
        <input type="hidden" name="cep" value="{{ session.get('user_cep') }}">
        <input type="hidden" name="city" value="{{ session.get('user_city') }}">
        <input type="hidden" name="addr" value="{{ session.get('user_addr') }}">
        <input type="hidden" name="num" value="{{ session.get('user_num') }}">
      {% else %}
        <!-- Campos para usuários anônimos -->
        <div class="mb-3">
          <label for="author" class="form-label fw-semibold">Nome:</label>
          <input type="text" id="author" name="author" class="form-control" required>
          <div class="invalid-feedback">Informe seu nome.</div>
        </div>

        <div class="mb-3">
          <label for="phone" class="form-label fw-semibold">Telefone:</label>
          <input type="tel" id="phone" name="phone" class="form-control" required>
          <div class="invalid-feedback">Informe um telefone válido.</div>
        </div>

        <div class="mb-3">
          <label for="cep" class="form-label fw-semibold">CEP:</label>
          <input type="text" id="cep" name="cep" class="form-control" required>
          <div class="invalid-feedback">Por favor, informe o CEP.</div>
        </div>

        <div class="mb-3">
          <label for="city" class="form-label fw-semibold">Cidade:</label>
          <select id="city" name="city" class="form-select" required>
            <option value="" disabled selected>Selecione uma cidade</option>
            {% for city in cities %}
              <option value="{{ city }}">{{ city }}</option>
            {% endfor %}
          </select>
          <div class="invalid-feedback">Informe a cidade.</div>
        </div>

        <div class="mb-3">
          <label for="addr" class="form-label fw-semibold">Endereço:</label>
          <input type="text" id="addr" name="addr" class="form-control" required>
          <div class="invalid-feedback">Informe o endereço.</div>
        </div>

        <div class="mb-3">
          <label for="num" class="form-label fw-semibold">Número:</label>
          <input type="text" id="num" name="num" class="form-control" required>
          <div class="invalid-feedback">Informe o número.</div>
        </div>

      {% endif %}

      <!-- Campos comuns -->
      <div class="mb-3">
        <label for="desc" class="form-label fw-semibold">Descrição:</label>
        <textarea id="desc" name="desc" class="form-control" rows="4" required></textarea>
        <div class="invalid-feedback">Descreva a situação.</div>
      </div>

      <div class="mb-3">
        <label for="photo" class="form-label fw-semibold">Foto do animal:</label>
        <input type="file" id="photo" name="photo" class="form-control" accept="image/*" required>
        <div class="invalid-feedback">Anexe uma foto do animal.</div>
      </div>

     <div class="col-12 text-center mt-4">
        <button type="submit" class="btn btn-success btn-lg px-5">Enviar Resgate</button>
      </div>
    </form>
    {% if not session.get('logged') %}
        <div class="col-12 mt-3">
          <div class="alert alert-warning text-center" role="alert">
          <strong>VOCÊ NÃO ESTÁ LOGADO, portanto a denúncia não será possível vê-la novamente.</strong><br>
                  Se quiser salvar, faça login.
          </div>
      </div>
      {% endif %}
  </div>
</div>

{% endblock conteudo %}
